<h1>RSVP Details</h1>

<%= form_for @family, :url => request.path do |f| %>
<div class="submit">
  <%= f.submit "Save and continue" %>
</div>

<h2>Family details</h2>
<p>Please ensure that we have correct and complete information for your family.</p>
<div class="input">
  <%= f.label :email %>
  <%= f.text_field :email %>
</div>
<div class="input">
  <%= f.label :phone %>
  <%= f.text_field :phone %>
</div>
<div class="input">
  <%= f.label :street_address %>
  <%= f.text_area :street_address, :rows => 3 %>
</div>

<% unless @family.members.where(:is_invited_ceremony => true).empty? %>
  <h2>Wedding Ceremony</h2>
  <p>The following family members are invited to the wedding ceremony - <strong>please select those who will be able to attend</strong>.</p>
  <%= f.fields_for :members, @family.members do |mf| %>
    <% if mf.object.invited_ceremony? %>
      <%= mf.check_box :is_attending_ceremony %>
      <%= mf.label :is_attending_ceremony, mf.object.name %>
    <% end %>
  <% end %>
<% end %>

<h2>Reception</h2>
<p>Please indicate which family members will be attending the reception, and what meal they will have.</p>
  <%= f.fields_for :members, @family.members do |mf| %>
    <div class="reception-member">
      <div class="input attendance">
        <%= mf.check_box :is_attending_reception %>
        <%= mf.label :is_attending_reception, mf.object.name %>
      </div>
      <div class="input meal">
        <%= mf.label :meal_id, "Meal choice" %>
        <% if mf.object.adult? %>
          <%= mf.collection_select :meal_id, Meal.where(:is_adult => true), :id, :name, :prompt => true %>
        <% end %>
      </div>
    </div>
  <% end %>

<h2>Leave a message</h2>
<p>If you have any additional comments or questions, leave a message here and we'll be in touch.</p>
<div class="input message">
  <%= f.text_area :rsvp_message, :rows => 5 %>
</div>

<div class="submit">
  <%= f.submit "Save and continue" %>
</div>
<% end %>
